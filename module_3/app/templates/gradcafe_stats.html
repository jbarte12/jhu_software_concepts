{% extends 'base.html' %}

<!-- ============================
     Page header
     ============================ -->
{% block header %}
<h2>GradCafe Application Statistics</h2>
{% endblock header %}

<!-- ============================
     Main content
     ============================ -->
{% block content %}

<!-- -------- Core statistics -------- -->
<p><strong>Fall 2026 Applicants:</strong> <em>{{ stats.fall_2026_count }}</em></p>
<p><strong>International Applicants (%):</strong> <em>{{ stats.international_pct }}%</em></p>
<p><strong>Average GPA:</strong> <em>{{ stats.avg_gpa }}</em></p>
<p><strong>Average GRE:</strong> <em>{{ stats.avg_gre }}</em></p>
<p><strong>Average GRE Verbal:</strong> <em>{{ stats.avg_gre_v }}</em></p>
<p><strong>Average GRE AW:</strong> <em>{{ stats.avg_gre_aw }}</em></p>
<p><strong>Average GPA (US, Fall 2026):</strong> <em>{{ stats.avg_gpa_us_fall_2026 }}</em></p>
<p><strong>Fall 2025 Acceptance Rate (%):</strong> <em>{{ stats.fall_2025_accept_pct }}%</em></p>

<p>
  <strong>Average GPA of Accepted Fall 2026 Applicants:</strong>
  <em>{{ stats.avg_gpa_fall_2026_accept }}</em>
</p>

<p><strong>JHU CS Master’s Applicants:</strong> <em>{{ stats.jhu_cs_masters }}</em></p>

<!-- -------- PhD CS acceptances -------- -->
<p>
  <strong>Fall 2026 PhD CS Acceptances (Raw):</strong>
  <em>{{ stats.fall_2026_cs_accept }}</em>
</p>

<p>
  <strong>Fall 2026 PhD CS Acceptances (LLM):</strong>
  <em>{{ stats.fall_2026_cs_accept_llm }}</em>
</p>

<!-- -------- Status / feedback messages -------- -->
{% if message %}
  <p class="status-message">{{ message }}</p>
{% endif %}

<!-- -------- Pull state messaging -------- -->
{% if pulling_data %}
  <!-- Shown while background refresh thread is running -->
  <p class="updating-message">Data is being pulled… please wait.</p>

{% elif pull_complete %}
  <!-- Shown once background refresh finishes -->
  <p class="success-message">
    Pull complete. You may now update analysis.
  </p>
{% endif %}

<!-- -------- Pull data button -------- -->
<form action="{{ url_for('pages.refresh_gradcafe') }}" method="post">
  <button
    class="btn-refresh"
    type="submit"
    {% if pulling_data %}disabled{% endif %}
  >
    Pull Data
  </button>
</form>

<!-- -------- Update analysis button -------- -->
<form action="{{ url_for('pages.update_analysis') }}" method="post">
  <button
    class="btn-update"
    type="submit"
    <!-- Disabled until pull completes AND while pulling -->
    {% if pulling_data or not pull_complete %}disabled{% endif %}
  >
    Update Analysis
  </button>
</form>

{% endblock content %}
